{
    "docs": [
        {
            "location": "/", 
            "text": "NDI PLATFORMS \n\n\nNDIplatforms is a set of Drush makefiles structured for easy maintenance. It\nis used, along with the \nAegir Hosting System\n, to\nmaintain NDI's \nDemTools\n mass-hosting platform, DemCloud.\n\n\nNormal usage of NDIplatforms involves simply running Drush Make with one of the\nsupplied \"lock\" files. Lockfiles are simply makefiles with all versions\ncompletely specified. Further instructions can be found on the\n\nUsage\n section.\n\n\nNDIplatforms uses a particular directory layout to make maintaining makefiles\neasier. For a discussion on the reasoning behind this, see the\n\nStructure\n section.\n\n\nThe maintenance of NDIplatforms leverages a number of features that are new to\nDrush 8. See the \nInstall\n section for a detailed walk-through of\ninstalling NDIplatforms and its dependencies.\n\n\nA specific workflow was developed to maintain the \"lock\" files. This workflow\nis described in the \nMaintenance\n section.\n\n\nThis documentation is managed with \nmkdocs\n. For\ninformation on getting started, see the \nDocumentation\n\nsection.", 
            "title": "Home"
        }, 
        {
            "location": "/#ndi-platforms", 
            "text": "NDIplatforms is a set of Drush makefiles structured for easy maintenance. It\nis used, along with the  Aegir Hosting System , to\nmaintain NDI's  DemTools  mass-hosting platform, DemCloud.  Normal usage of NDIplatforms involves simply running Drush Make with one of the\nsupplied \"lock\" files. Lockfiles are simply makefiles with all versions\ncompletely specified. Further instructions can be found on the Usage  section.  NDIplatforms uses a particular directory layout to make maintaining makefiles\neasier. For a discussion on the reasoning behind this, see the Structure  section.  The maintenance of NDIplatforms leverages a number of features that are new to\nDrush 8. See the  Install  section for a detailed walk-through of\ninstalling NDIplatforms and its dependencies.  A specific workflow was developed to maintain the \"lock\" files. This workflow\nis described in the  Maintenance  section.  This documentation is managed with  mkdocs . For\ninformation on getting started, see the  Documentation \nsection.", 
            "title": "NDI PLATFORMS"
        }, 
        {
            "location": "/install/", 
            "text": "INSTALLATION \n\n\nDownload\n\n\nDownload NDIplatforms somewhere convenient, such as:\n\n\n$ \ngit clone https://github.com/nditech/NDIplatforms.git ~/makefiles/NDIplatforms\n\n$ \ncd\n ~/makefiles/NDIplatforms\n\n\n\n\n\nInstall\n\n\nTo use the latest version of NDIplatforms effectively, you need a recent version\nof Drush. As such, we recommend using a local Drush install, so as not to\ninterfere with other Drush functionality on the server.\n\n\nThere are various options available, that are explained further in the next\nsection. Use the following command to install the recommended version of Drush:\n\n\n$ \nmake install\nSwitched to branch \ndev/2000\n\n\n[\n...\n]\n\n Drush git branch: dev/2000\n\n\n\n\n\nInstall Drush\n\n\nIf you prefer to use the latest release of Drush:\n\n\n$ \nmake drush\n Drush Version   :  8.0.3\n\n\n\n\n\nAlternatively, you might want to use the latest (unstable) Drush development\nbuild:\n\n\n$ \nmake drush-unstable\n Drush Version   :  8.1-dev\n\n\n\n\n\nYou could also deploy Drush from source code:\n\n\n$ \nmake drush-source\nAlready on \nmaster\n\n\n[\n...\n]\n\nAll settings correct \nfor\n using Composer\nDownloading...\n\n[\n...\n]\n\n Drush Version   :  8.1-dev\n\n\n\n\n\nFinally, deploying Drush from source code allows the use of arbitrary branches\n(from a PR, for example):\n\n\n$ \nmake drush-source \nbranch\n=\ndev/2000\nSwitched to branch \ndev/2000\n\n\n[\n...\n]\n\n Drush git branch: dev/2000", 
            "title": "Install"
        }, 
        {
            "location": "/install/#installation", 
            "text": "", 
            "title": "INSTALLATION"
        }, 
        {
            "location": "/install/#download", 
            "text": "Download NDIplatforms somewhere convenient, such as:  $  git clone https://github.com/nditech/NDIplatforms.git ~/makefiles/NDIplatforms $  cd  ~/makefiles/NDIplatforms", 
            "title": "Download"
        }, 
        {
            "location": "/install/#install", 
            "text": "To use the latest version of NDIplatforms effectively, you need a recent version\nof Drush. As such, we recommend using a local Drush install, so as not to\ninterfere with other Drush functionality on the server.  There are various options available, that are explained further in the next\nsection. Use the following command to install the recommended version of Drush:  $  make install\nSwitched to branch  dev/2000  [ ... ] \n Drush git branch: dev/2000", 
            "title": "Install"
        }, 
        {
            "location": "/install/#install-drush", 
            "text": "If you prefer to use the latest release of Drush:  $  make drush\n Drush Version   :  8.0.3  Alternatively, you might want to use the latest (unstable) Drush development\nbuild:  $  make drush-unstable\n Drush Version   :  8.1-dev  You could also deploy Drush from source code:  $  make drush-source\nAlready on  master  [ ... ] \nAll settings correct  for  using Composer\nDownloading... [ ... ] \n Drush Version   :  8.1-dev  Finally, deploying Drush from source code allows the use of arbitrary branches\n(from a PR, for example):  $  make drush-source  branch = dev/2000\nSwitched to branch  dev/2000  [ ... ] \n Drush git branch: dev/2000", 
            "title": "Install Drush"
        }, 
        {
            "location": "/usage/", 
            "text": "USAGE \n\n\nThis section describes building platforms using the NDIplatforms stub Drush\nmakefiles. To understand how these makefiles are maintained, please see\nthe \nMaintenance\n section.\n\n\nGNU Make\n\n\nWhile most of Drupal platform creation refers to Drush makefiles, this project\nincludes a \nGNU Makefile\n to simplify its\nusage. To see what commands are available, run:\n\n\n$ \nmake list\n\n\n\n\n\nFor simplicity, we use the \"demtools/dkan\" platform in our examples. Obviously,\nreplace this with whichever platform stub makefile is appropriate.\n\n\nTest a platform build\n\n\nBefore proceeding with deploying a platform for production use, it can be\nuseful to run a test build, to see if there are any errors in the lockfile.\nNote that we run \nautomated tests\n\nto build the DemTools platforms after each code push to the NDIplatforms\nproject. However, changes to included project (e.g., reference git branch\ndeleted) since then might cause a build to break.\n\n\nTo run a test build, simply run:\n\n\n$ \nmake demtools/dkan-test\nBeginning to build makefiles/demtools/dkan/lock.yml.                 \n[\nok\n]\n\ndrupal-7.43 downloaded.                                              \n[\nok\n]\n\n\n[\n...\n]\n\n\n\n\n\n\nEach DemTools platform (demtools/dkan, demtools/civicrm, etc.) have such a test\ncommand defined (although it may not show up in the \nmake list\n output).\n\n\nNote that running such a test will re-compile any relevant lockfiles whose\nsources have changed. See the \nStructure\n and\n\nMaintenance\n sections for further details.\n\n\nBuild a platform\n\n\nThe easiest way to build a platform is to use the provided Make commands:\n\n\n$ \nmake demtools/dkan-platform\nBeginning to build makefiles/demtools/dkan/lock.yml.                 \n[\nok\n]\n\ndrupal-7.43 downloaded.                                              \n[\nok\n]\n\n\n[\n...\n]\n\n\n\n\n\n\nEach DemTools platform (demtools/dkan, demtools/civicrm, etc.) has such a\nplatform build command defined (although it may not show up in the \nmake list\n\noutput).\n\n\nThis command will build the platform to the usual production path on a stock\nAegir system, create an Aegir \"context\" (Drush alias), and import the resulting\nplatform into the Aegir front-end.\n\n\nThe resulting platform will incorporate a date-stamp to make it simple to see\nwhich is the most current. If multiple platforms of the same type are required\nduring the course of a single day (e.g., for iterative bug fixing and testing),\nwe can include a revision counter to keep platforms and aliases unique. To do\nso, simply add \ninc=\nsuffix\n when calling the platform build command:\n\n\n$ \nmake demtools/dkan-platform \ninc\n=\na\nBeginning to build makefiles/demtools/dkan/lock.yml.                 \n[\nok\n]\n\ndrupal-7.43 downloaded.                                              \n[\nok\n]\n\n\n[\n...\n]\n\n\n\n\n\n\nBuild a platform on the command-line\n\n\nTo build a platform (also referred to as a code-base), we can also use Drush\nMake directly, along with our lockfiles. We start by simply calling Drush make\n(usually as the \"aegir\" user):\n\n\n$ \ndrush make ~/makefiles/NDIplatforms/makefiles/demtools/dkan/lock.yml ~/platforms/DemTools_DKAN_2016-02-22\nBeginning to build makefiles/demtools/dkan/lock.yml.                 \n[\nok\n]\n\ndrupal-7.43 downloaded.                                              \n[\nok\n]\n\n\n[\n...\n]\n\n\n\n\n\n\nAssuming that the platform build worked, we then need to tell Aegir about it.\nThe easiest way to do that is to visit \n/node/add/platform\n on the Aegir site.\nWe then need to provide a name, such as \"DemTools_DKAN_2016-02-22\", and specify\nthe path where we built it.\n\n\nThis can also be accomplished at the command-line by running the provision-save\nand hosting-import Drush commands provided by Aegir. However, this is a very\nadvanced technique which we will not cover here.  Use the \"--help\" option with\nthese commands to see how they work, or check out our use in the Makefile that\nships with NDIplatforms.\n\n\nBuild a platform in the Aegir UI\n\n\nAlternatively, we can build the platform directly from within the Aegir UI.\nThis is the preferred method, as it:\n\n\n\n\nmakes the output of the platform build available in the task log;\n\n\ncreates a link to the makefile that was used in building the platform; and\n\n\navoids having to import the platform separately.\n\n\n\n\nHowever, YAML-formatted makefiles require Drush 8, which only shipped with\nAegir Debian packages starting in version 3.4. As a result, building from the\ncommand line may be required, if you are using an older version.\n\n\nFirst, find the lockfile we want to use to build the platform on Github. Visit\nthe \nNDIplatforms project on GitHub\n.\nFrom here, we'll want to work from the latest commit, as this will allow us to\nspecify the commit hash in the makefile path. The benefit of doing so, is that\nwe'll know \nexactly\n what the makefile contained at the time that we buil this\nplatform. This can turn out to be very useful later.\n\n\nEither follow the \"Latest commit\" link, or append\n\n/commit/HEAD\n to the\nproject URL. We'll start seeing a long commit hash is subsequently. Click on\nthe \"Browse files\" link to get back to the tree view of the project. Then\nnavigate into the \nmakefiles/demtools/\n directory, and choose which DemTools\nplatform to build.\n\n\nIn this directory, we'll find a \nlock.yml\n file. This will show all the\ncomponents that will be pulled together to form the platform.  Next, click the\n\"Raw\" button to get a link to the output that Drush Make can\naccept. Here's an example of such a URL:\n\n\n\n\nhttps://raw.githubusercontent.com/nditech/NDIplatforms/5f93ef3c183574a79a7132bfce865e3f76894235/makefiles/demtools/dkan/lock.yml\n\n\n\n\nCopy that URL into the \"makefile\" field on \"/node/add/platform\" on the\nAegir site. Then provide a meaningful name, such as \"DemTools_2016-02-25\", and\nclick \"Save\".\n\n\nThat should be all that is required. In the background, Aegir will download the\nmakefile, run Drush Make, and register the platform. You should see a link to\nthe makefile used in creating the platform. This is useful to determine the\nexact platform contents, or for re-creating the platform elsewhere, such as on\na different server.", 
            "title": "Usage"
        }, 
        {
            "location": "/usage/#usage", 
            "text": "This section describes building platforms using the NDIplatforms stub Drush\nmakefiles. To understand how these makefiles are maintained, please see\nthe  Maintenance  section.", 
            "title": "USAGE"
        }, 
        {
            "location": "/usage/#gnu-make", 
            "text": "While most of Drupal platform creation refers to Drush makefiles, this project\nincludes a  GNU Makefile  to simplify its\nusage. To see what commands are available, run:  $  make list  For simplicity, we use the \"demtools/dkan\" platform in our examples. Obviously,\nreplace this with whichever platform stub makefile is appropriate.", 
            "title": "GNU Make"
        }, 
        {
            "location": "/usage/#test-a-platform-build", 
            "text": "Before proceeding with deploying a platform for production use, it can be\nuseful to run a test build, to see if there are any errors in the lockfile.\nNote that we run  automated tests \nto build the DemTools platforms after each code push to the NDIplatforms\nproject. However, changes to included project (e.g., reference git branch\ndeleted) since then might cause a build to break.  To run a test build, simply run:  $  make demtools/dkan-test\nBeginning to build makefiles/demtools/dkan/lock.yml.                  [ ok ] \ndrupal-7.43 downloaded.                                               [ ok ]  [ ... ]   Each DemTools platform (demtools/dkan, demtools/civicrm, etc.) have such a test\ncommand defined (although it may not show up in the  make list  output).  Note that running such a test will re-compile any relevant lockfiles whose\nsources have changed. See the  Structure  and Maintenance  sections for further details.", 
            "title": "Test a platform build"
        }, 
        {
            "location": "/usage/#build-a-platform", 
            "text": "The easiest way to build a platform is to use the provided Make commands:  $  make demtools/dkan-platform\nBeginning to build makefiles/demtools/dkan/lock.yml.                  [ ok ] \ndrupal-7.43 downloaded.                                               [ ok ]  [ ... ]   Each DemTools platform (demtools/dkan, demtools/civicrm, etc.) has such a\nplatform build command defined (although it may not show up in the  make list \noutput).  This command will build the platform to the usual production path on a stock\nAegir system, create an Aegir \"context\" (Drush alias), and import the resulting\nplatform into the Aegir front-end.  The resulting platform will incorporate a date-stamp to make it simple to see\nwhich is the most current. If multiple platforms of the same type are required\nduring the course of a single day (e.g., for iterative bug fixing and testing),\nwe can include a revision counter to keep platforms and aliases unique. To do\nso, simply add  inc= suffix  when calling the platform build command:  $  make demtools/dkan-platform  inc = a\nBeginning to build makefiles/demtools/dkan/lock.yml.                  [ ok ] \ndrupal-7.43 downloaded.                                               [ ok ]  [ ... ]", 
            "title": "Build a platform"
        }, 
        {
            "location": "/usage/#build-a-platform-on-the-command-line", 
            "text": "To build a platform (also referred to as a code-base), we can also use Drush\nMake directly, along with our lockfiles. We start by simply calling Drush make\n(usually as the \"aegir\" user):  $  drush make ~/makefiles/NDIplatforms/makefiles/demtools/dkan/lock.yml ~/platforms/DemTools_DKAN_2016-02-22\nBeginning to build makefiles/demtools/dkan/lock.yml.                  [ ok ] \ndrupal-7.43 downloaded.                                               [ ok ]  [ ... ]   Assuming that the platform build worked, we then need to tell Aegir about it.\nThe easiest way to do that is to visit  /node/add/platform  on the Aegir site.\nWe then need to provide a name, such as \"DemTools_DKAN_2016-02-22\", and specify\nthe path where we built it.  This can also be accomplished at the command-line by running the provision-save\nand hosting-import Drush commands provided by Aegir. However, this is a very\nadvanced technique which we will not cover here.  Use the \"--help\" option with\nthese commands to see how they work, or check out our use in the Makefile that\nships with NDIplatforms.", 
            "title": "Build a platform on the command-line"
        }, 
        {
            "location": "/usage/#build-a-platform-in-the-aegir-ui", 
            "text": "Alternatively, we can build the platform directly from within the Aegir UI.\nThis is the preferred method, as it:   makes the output of the platform build available in the task log;  creates a link to the makefile that was used in building the platform; and  avoids having to import the platform separately.   However, YAML-formatted makefiles require Drush 8, which only shipped with\nAegir Debian packages starting in version 3.4. As a result, building from the\ncommand line may be required, if you are using an older version.  First, find the lockfile we want to use to build the platform on Github. Visit\nthe  NDIplatforms project on GitHub .\nFrom here, we'll want to work from the latest commit, as this will allow us to\nspecify the commit hash in the makefile path. The benefit of doing so, is that\nwe'll know  exactly  what the makefile contained at the time that we buil this\nplatform. This can turn out to be very useful later.  Either follow the \"Latest commit\" link, or append /commit/HEAD  to the\nproject URL. We'll start seeing a long commit hash is subsequently. Click on\nthe \"Browse files\" link to get back to the tree view of the project. Then\nnavigate into the  makefiles/demtools/  directory, and choose which DemTools\nplatform to build.  In this directory, we'll find a  lock.yml  file. This will show all the\ncomponents that will be pulled together to form the platform.  Next, click the\n\"Raw\" button to get a link to the output that Drush Make can\naccept. Here's an example of such a URL:   https://raw.githubusercontent.com/nditech/NDIplatforms/5f93ef3c183574a79a7132bfce865e3f76894235/makefiles/demtools/dkan/lock.yml   Copy that URL into the \"makefile\" field on \"/node/add/platform\" on the\nAegir site. Then provide a meaningful name, such as \"DemTools_2016-02-25\", and\nclick \"Save\".  That should be all that is required. In the background, Aegir will download the\nmakefile, run Drush Make, and register the platform. You should see a link to\nthe makefile used in creating the platform. This is useful to determine the\nexact platform contents, or for re-creating the platform elsewhere, such as on\na different server.", 
            "title": "Build a platform in the Aegir UI"
        }, 
        {
            "location": "/structure/", 
            "text": "STRUCTURE \n\n\nThis section describes the filesystem layout for NDIplatforms Drush makefiles.\nTo understand how to use them to build platforms, please see the\n\nUsage\n section. To better understand how these makefiles are\nmaintained, please see the \nMaintenance\n section.\n\n\nFilesystem layout\n\n\nFor simplicity, we are limiting our discussion to the DemTools Civi and DKAN\nplatforms. Several more platforms will be included in NDIplatforms, and this\nsystem scales very well. However, listing them all here would complicate\nexplanations.\n\n\nDrush makefiles allow for the inclusion of other makefiles. In order to reduce\nduplication and encourage these makefiles to be self-documenting, NDIplatforms\nmakes extensive use of makefile includes.\n\n\nHere is the layout of \nmakefiles/\n directory:\n\n\n$ \ntree makefiles\nmakefiles/\n\u251c\u2500\u2500 cores\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 drupal7\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 core.make.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 lock.yml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 drupal8\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 core.make.yml\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 lock.yml\n\u251c\u2500\u2500 demtools\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 civicrm\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 contrib.make.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 custom.make.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 lock.yml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 dkan\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 contrib.make.yml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 custom.make.yml\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 lock.yml\n\u2514\u2500\u2500 stock\n    \u251c\u2500\u2500 civicrm\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 build.yml\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 contrib.make.yml\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 lock.yml\n    \u2514\u2500\u2500 dkan\n        \u251c\u2500\u2500 build.yml\n        \u251c\u2500\u2500 lock.yml\n        \u2514\u2500\u2500 profile.make.yml\n\n\n9\n directories, \n20\n files\n\n\n\n\n\nThere are 3 top-level directories: \ncores/\n, \nstock/\n and \ndemtools/\n. \ncores/\n\ncontains various versions of Drupal. \nstock/\n contains basic implementations of\nunderlying applications: CiviCRM and DKAN. These are useful for debugging, and\nisolating issues between the applications and the DemTools customizations.\nFinally, \ndemtools/\n contains the platforms used by DemTools: stock\napplications plus addtional contrib and custom components.\n\n\nWe examine these in more detail later.\n\n\nTypes of Drush makefiles\n\n\n*.make.yml\n\n\nThese Drush makefiles define projects and libraries, but normally don't specify\nany versions. They are not usually used on their own. Instead they get included\nin build makefiles.\n\n\nbuild.yml\n\n\nBuild makefiles, sometimes called stubs, do not contain any actual project\ndefinitions. Instead, they only include other makefiles (of the .make.yml\nvariety) that define the core, extentions, and themes used. It may also contain\noverrides to the projects defined in the includes.\n\n\nlock.yml\n\n\nLockfiles are generated from build makefiles (see the\n\nMaintenance\n section. They have versions specified for all\nprojects. This helps in ensuring that deployments of platforms (code-bases)\nfrom them are repeatable.  This process takes a stub (build) makefile, compiles\nall its inclusions, then checks with http://update.drupal.org to determine the\nlatest versions of all the components. This is then written out as a lockfile,\nsimilar to what we see with Composer or Gem.\n\n\nCores\n\n\nTBD\n\n\nStock\n\n\nTBD\n\n\nDemTools\n\n\nTBD", 
            "title": "Structure"
        }, 
        {
            "location": "/structure/#structure", 
            "text": "This section describes the filesystem layout for NDIplatforms Drush makefiles.\nTo understand how to use them to build platforms, please see the Usage  section. To better understand how these makefiles are\nmaintained, please see the  Maintenance  section.", 
            "title": "STRUCTURE"
        }, 
        {
            "location": "/structure/#filesystem-layout", 
            "text": "For simplicity, we are limiting our discussion to the DemTools Civi and DKAN\nplatforms. Several more platforms will be included in NDIplatforms, and this\nsystem scales very well. However, listing them all here would complicate\nexplanations.  Drush makefiles allow for the inclusion of other makefiles. In order to reduce\nduplication and encourage these makefiles to be self-documenting, NDIplatforms\nmakes extensive use of makefile includes.  Here is the layout of  makefiles/  directory:  $  tree makefiles\nmakefiles/\n\u251c\u2500\u2500 cores\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 drupal7\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 core.make.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 lock.yml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 drupal8\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 core.make.yml\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 lock.yml\n\u251c\u2500\u2500 demtools\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 civicrm\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 contrib.make.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 custom.make.yml\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 lock.yml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 dkan\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 build.yml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 contrib.make.yml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 custom.make.yml\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 lock.yml\n\u2514\u2500\u2500 stock\n    \u251c\u2500\u2500 civicrm\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 build.yml\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 contrib.make.yml\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 lock.yml\n    \u2514\u2500\u2500 dkan\n        \u251c\u2500\u2500 build.yml\n        \u251c\u2500\u2500 lock.yml\n        \u2514\u2500\u2500 profile.make.yml 9  directories,  20  files  There are 3 top-level directories:  cores/ ,  stock/  and  demtools/ .  cores/ \ncontains various versions of Drupal.  stock/  contains basic implementations of\nunderlying applications: CiviCRM and DKAN. These are useful for debugging, and\nisolating issues between the applications and the DemTools customizations.\nFinally,  demtools/  contains the platforms used by DemTools: stock\napplications plus addtional contrib and custom components.  We examine these in more detail later.", 
            "title": "Filesystem layout"
        }, 
        {
            "location": "/structure/#types-of-drush-makefiles", 
            "text": "", 
            "title": "Types of Drush makefiles"
        }, 
        {
            "location": "/structure/#42makeyml", 
            "text": "These Drush makefiles define projects and libraries, but normally don't specify\nany versions. They are not usually used on their own. Instead they get included\nin build makefiles.", 
            "title": "*.make.yml"
        }, 
        {
            "location": "/structure/#buildyml", 
            "text": "Build makefiles, sometimes called stubs, do not contain any actual project\ndefinitions. Instead, they only include other makefiles (of the .make.yml\nvariety) that define the core, extentions, and themes used. It may also contain\noverrides to the projects defined in the includes.", 
            "title": "build.yml"
        }, 
        {
            "location": "/structure/#lockyml", 
            "text": "Lockfiles are generated from build makefiles (see the Maintenance  section. They have versions specified for all\nprojects. This helps in ensuring that deployments of platforms (code-bases)\nfrom them are repeatable.  This process takes a stub (build) makefile, compiles\nall its inclusions, then checks with http://update.drupal.org to determine the\nlatest versions of all the components. This is then written out as a lockfile,\nsimilar to what we see with Composer or Gem.", 
            "title": "lock.yml"
        }, 
        {
            "location": "/structure/#cores", 
            "text": "TBD", 
            "title": "Cores"
        }, 
        {
            "location": "/structure/#stock", 
            "text": "TBD", 
            "title": "Stock"
        }, 
        {
            "location": "/structure/#demtools", 
            "text": "TBD", 
            "title": "DemTools"
        }, 
        {
            "location": "/maintenance/", 
            "text": "MAINTENANCE \n\n\nThis section describes how to maintain Drush Make lockfiles. To understand how\nto build platforms using them, please see the \nUsage\n section. To\nbetter understand how these makefiles are structured, please see the\n\nStructure\n section.\n\n\nPlease follow the installation instructions in the \nInstall\n\nsection, as we currently recommend using a git version of Drush. The usage\ninstructions below assume that you have followed those instructions exactly.\n\n\nFor simplicity, we use the \"demtools/dkan\" project in our examples. Obviously,\nreplace this with whichever platform is appropriate.\n\n\nDrush Make lockfiles\n\n\nThe principle benefit of using lockfiles, over regular makefiles, is that they\nallow us to build the same platform in a repeatable fashion. A lockfile is\nsimply a type of makefile generated by Drush, that specifies all the versions\nfor all the included projects. Otherwise, we might get a different platform\neach time we build, depending on how many projects we include, their release\ncycle and/or the pace of their development.\n\n\nAlso, lockfiles allow us to build platforms using the lockfiles remotely,\nwithout having to be concerned with any includes being specified locally. For\nexample, we can use the raw output of a git repository containing such a\nlockfile, and be confident that any subseqent platform built with that same URL\nwill be identical.\n\n\nUpdate your makefiles\n\n\nFirst, we create a temporary lockfile based on a given platform stub:\n\n\n$ \ndrush7 make --no-build --lock\n=\n/tmp/make.lock stubs/ndi-polls.make\nWrote .make file /tmp/make.lock\n\n\n\n\n\nNote: the --lock parameter does not work with the ~ path shortcut.\n\n\nThen, we compare it to the current lockfile, so we can see what changes have\noccurred:\n\n\n$ \ndrush7 diff locks/ndi-polls.lock /tmp/make.lock --list\n=\n0\n Project  Old version  New version  Notices                            \n drupal   7.38         7.39         version upgraded, patches changed.\n\n\n\n\n\nInvestigate and fix any warnings as appropriate.  This will generally involve\npinning a version for a module.  This is done by commenting out the module from\nthe general modules list (i.e., includes/modules.make), then adding an entry\nin the modules pin list (e.g., includes/modules-pins.make):\n\n\n; The recommended release is on the 2.x branch, so we pin to the latest\n; supported version on the 1.x branch.\n; For updates, check: https://drupal.org/project/google_analytics\nprojects[goole_analytics][version] = 1\n\n\n\n\n\nIt is usually best to pin to a major version in this case, so that new releases\non that branch are incorporated automatically.\n\n\nRe-running the commands above should now no longer show any major version\nupgrade warnings.\n\n\nTest the new lockfile\n\n\nIt is usually worthwhile to test the new lockfile at this point. For example,\nan update to a module could cause a patch to no longer apply. Usually, in such\ncases, updating the makefile with a new patch, or simply removing patches that\nhave been incorporated into the new release, will be sufficient to resolve any\nissues at this stage.\n\n\nAdding or changing patches or libraries, adding new modules or themes, and\nother such modifications can also cause build failures. Running a test build is\nas simple as running drush make on the new lockfile:\n\n\n$ \ndrush7 make /tmp/make.lock test_demtools\n\n\n\n\n\nFinalize the new lockfile\n\n\nOnce all changes and warnings are resolved or accepted, and documented, we copy\nthe temporary lockfile over the existing one in our repo:\n\n\n$ \ncp /tmp/make.lock locks/ndi-polls.lock\n\n\n\n\n\nThen commit these changes into git:\n\n\n$ \ngit commit -am\nUpdate NDI\ns common platform.\n\n\n\n\n\n\nIt may also be useful to include the output of \"drush make-diff\" in the commit\nmessage.", 
            "title": "Maintenance"
        }, 
        {
            "location": "/maintenance/#maintenance", 
            "text": "This section describes how to maintain Drush Make lockfiles. To understand how\nto build platforms using them, please see the  Usage  section. To\nbetter understand how these makefiles are structured, please see the Structure  section.  Please follow the installation instructions in the  Install \nsection, as we currently recommend using a git version of Drush. The usage\ninstructions below assume that you have followed those instructions exactly.  For simplicity, we use the \"demtools/dkan\" project in our examples. Obviously,\nreplace this with whichever platform is appropriate.", 
            "title": "MAINTENANCE"
        }, 
        {
            "location": "/maintenance/#drush-make-lockfiles", 
            "text": "The principle benefit of using lockfiles, over regular makefiles, is that they\nallow us to build the same platform in a repeatable fashion. A lockfile is\nsimply a type of makefile generated by Drush, that specifies all the versions\nfor all the included projects. Otherwise, we might get a different platform\neach time we build, depending on how many projects we include, their release\ncycle and/or the pace of their development.  Also, lockfiles allow us to build platforms using the lockfiles remotely,\nwithout having to be concerned with any includes being specified locally. For\nexample, we can use the raw output of a git repository containing such a\nlockfile, and be confident that any subseqent platform built with that same URL\nwill be identical.", 
            "title": "Drush Make lockfiles"
        }, 
        {
            "location": "/maintenance/#update-your-makefiles", 
            "text": "First, we create a temporary lockfile based on a given platform stub:  $  drush7 make --no-build --lock = /tmp/make.lock stubs/ndi-polls.make\nWrote .make file /tmp/make.lock  Note: the --lock parameter does not work with the ~ path shortcut.  Then, we compare it to the current lockfile, so we can see what changes have\noccurred:  $  drush7 diff locks/ndi-polls.lock /tmp/make.lock --list = 0\n Project  Old version  New version  Notices                            \n drupal   7.38         7.39         version upgraded, patches changed.  Investigate and fix any warnings as appropriate.  This will generally involve\npinning a version for a module.  This is done by commenting out the module from\nthe general modules list (i.e., includes/modules.make), then adding an entry\nin the modules pin list (e.g., includes/modules-pins.make):  ; The recommended release is on the 2.x branch, so we pin to the latest\n; supported version on the 1.x branch.\n; For updates, check: https://drupal.org/project/google_analytics\nprojects[goole_analytics][version] = 1  It is usually best to pin to a major version in this case, so that new releases\non that branch are incorporated automatically.  Re-running the commands above should now no longer show any major version\nupgrade warnings.", 
            "title": "Update your makefiles"
        }, 
        {
            "location": "/maintenance/#test-the-new-lockfile", 
            "text": "It is usually worthwhile to test the new lockfile at this point. For example,\nan update to a module could cause a patch to no longer apply. Usually, in such\ncases, updating the makefile with a new patch, or simply removing patches that\nhave been incorporated into the new release, will be sufficient to resolve any\nissues at this stage.  Adding or changing patches or libraries, adding new modules or themes, and\nother such modifications can also cause build failures. Running a test build is\nas simple as running drush make on the new lockfile:  $  drush7 make /tmp/make.lock test_demtools", 
            "title": "Test the new lockfile"
        }, 
        {
            "location": "/maintenance/#finalize-the-new-lockfile", 
            "text": "Once all changes and warnings are resolved or accepted, and documented, we copy\nthe temporary lockfile over the existing one in our repo:  $  cp /tmp/make.lock locks/ndi-polls.lock  Then commit these changes into git:  $  git commit -am Update NDI s common platform.   It may also be useful to include the output of \"drush make-diff\" in the commit\nmessage.", 
            "title": "Finalize the new lockfile"
        }, 
        {
            "location": "/documentation/", 
            "text": "DOCUMENTATION \n\n\nWe maintain the NDIplatform documentation site using\n\nmkdocs\n to build this site. To get started\ncontributing to this project, fork it on Github. Then install mkdocs and clone\nthis repo:\n\n\n$ \nsudo brew install python              \n# For OSX users\n\n\n$ \nsudo aptitude install python-pip      \n# For Debian/Ubuntu users\n\n\n$ \nsudo pip install mkdocs\n\n$ \ngit clone https://github.com/NDItech/NDIplatforms.git\n\n$ \ncd \nNDIplatforms\n\n$ \ngit remote add sandbox https://github.com/\nusername\n/NDIplatforms.git\n\n$ \nmkdocs serve\n\n\n\n\n\nYour local NDIplatforms docs site should now be available for browsing:\n\nhttp://127.0.0.1:8000/\n. When you find a typo, an error, unclear or missing\nexplanations or instructions, hit ctrl-c, to stop the server, and start\nediting. Find the page you\u2019d like to edit; everything is in the docs/\ndirectory. Make your changes, commit and push them, and start a pull request:\n\n\n$ \ngit checkout -b fix_typo\n\n$ \nvim docs/index.md                     \n# Add/edit/remove whatever you see fit. Be bold!\n\n\n$ \nmkdocs build --clean\n;\n mkdocs serve    \n# Go check your changes. We\u2019ll wait...\n\n\n$ \ngit diff                              \n# Make sure there aren\u2019t any unintended changes.\n\ndiff --git a/docs/index.md b/docs/index.md\n...\n\n$ \ngit commit -am\u201dFixed typo.\u201d           \n# Useful commit message are a good habit.\n\n\n$ \ngit push sandbox fix_typo\n\n\n\n\n\nVisit your fork on Github and start a Pull Request.", 
            "title": "Documentation"
        }, 
        {
            "location": "/documentation/#documentation", 
            "text": "We maintain the NDIplatform documentation site using mkdocs  to build this site. To get started\ncontributing to this project, fork it on Github. Then install mkdocs and clone\nthis repo:  $  sudo brew install python               # For OSX users  $  sudo aptitude install python-pip       # For Debian/Ubuntu users  $  sudo pip install mkdocs $  git clone https://github.com/NDItech/NDIplatforms.git $  cd  NDIplatforms $  git remote add sandbox https://github.com/ username /NDIplatforms.git $  mkdocs serve  Your local NDIplatforms docs site should now be available for browsing: http://127.0.0.1:8000/ . When you find a typo, an error, unclear or missing\nexplanations or instructions, hit ctrl-c, to stop the server, and start\nediting. Find the page you\u2019d like to edit; everything is in the docs/\ndirectory. Make your changes, commit and push them, and start a pull request:  $  git checkout -b fix_typo $  vim docs/index.md                      # Add/edit/remove whatever you see fit. Be bold!  $  mkdocs build --clean ;  mkdocs serve     # Go check your changes. We\u2019ll wait...  $  git diff                               # Make sure there aren\u2019t any unintended changes. \ndiff --git a/docs/index.md b/docs/index.md\n... $  git commit -am\u201dFixed typo.\u201d            # Useful commit message are a good habit.  $  git push sandbox fix_typo  Visit your fork on Github and start a Pull Request.", 
            "title": "DOCUMENTATION"
        }
    ]
}